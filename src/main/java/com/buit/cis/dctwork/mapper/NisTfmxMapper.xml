<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--  -->
<mapper namespace="com.buit.cis.dctwork.dao.NisTfmxDao">

    <!-- 用于select查询公用抽取的列 -->
    <sql id="columns">
        ZYH as zyh,FYXH as fyxh,SQRQ as sqrq,JGID as jgid,TFRQ as tfrq,FYDW as fydw,FYJG as fyjg,TFSL as tfsl,ZFBL as zfbl,YEPB as yepb,TFBQ as tfbq,CZGH as czgh,YZID as yzid,FYXM as fyxm
    </sql>

    <insert id="insert">
        INSERT INTO NIS_TFMX (
            ZYH ,
            FYXH ,
            SQRQ ,
            JGID ,
            TFRQ ,
            FYDW ,
            FYJG ,
            TFSL ,
            ZFBL ,
            YEPB ,
            TFBQ ,
            CZGH ,
            YZID ,
            FYXM 
        ) VALUES (
            #{zyh} ,
            #{fyxh} ,
            #{sqrq} ,
            #{jgid} ,
            #{tfrq} ,
            #{fydw} ,
            #{fyjg} ,
            #{tfsl} ,
            #{zfbl} ,
            #{yepb} ,
            #{tfbq} ,
            #{czgh} ,
            #{yzid} ,
            #{fyxm} 
        )
    </insert>
    
    <update id="update" ><!--  
        UPDATE NIS_TFMX SET
            FYXH = #{fyxh} ,
            SQRQ = #{sqrq} ,
            JGID = #{jgid} ,
            TFRQ = #{tfrq} ,
            FYDW = #{fydw} ,
            FYJG = #{fyjg} ,
            TFSL = #{tfsl} ,
            ZFBL = #{zfbl} ,
            YEPB = #{yepb} ,
            TFBQ = #{tfbq} ,
            CZGH = #{czgh} ,
            YZID = #{yzid} ,
            FYXM = #{fyxm} 
        WHERE 
            ZYH = #{zyh} 
            -->            
    </update>

    <delete id="deleteById">
        DELETE FROM NIS_TFMX WHERE
        ZYH = #{zyh} 
    </delete>
    
    <delete id="removeByEntity">
        DELETE FROM NIS_TFMX <include refid="where"/>  
    </delete>
    
    <select id="getById" resultType="NisTfmx">
        SELECT <include refid="columns" />
            FROM NIS_TFMX 
            WHERE 
        ZYH = #{zyh} 
    </select>
    
    <sql id="where">
        <where>                          
<!--                <if test="@sqlt.Ognl@isNotEmpty(zyh)"> -->
<!--                     AND ZYH = #{zyh} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(fyxh)"> -->
<!--                     AND FYXH = #{fyxh} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(sqrq)"> -->
<!--                     AND SQRQ = #{sqrq} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(jgid)"> -->
<!--                     AND JGID = #{jgid} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(tfrq)"> -->
<!--                     AND TFRQ = #{tfrq} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(fydw)"> -->
<!--                     AND FYDW = #{fydw} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(fyjg)"> -->
<!--                     AND FYJG = #{fyjg} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(tfsl)"> -->
<!--                     AND TFSL = #{tfsl} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(zfbl)"> -->
<!--                     AND ZFBL = #{zfbl} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(yepb)"> -->
<!--                     AND YEPB = #{yepb} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(tfbq)"> -->
<!--                     AND TFBQ = #{tfbq} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(czgh)"> -->
<!--                     AND CZGH = #{czgh} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(yzid)"> -->
<!--                     AND YZID = #{yzid} -->
<!--                </if> -->
<!--                <if test="@sqlt.Ognl@isNotEmpty(fyxm)"> -->
<!--                     AND FYXM = #{fyxm} -->
<!--                </if> -->
        </where>
    </sql>
        
    <select id="findByEntityCount" resultType="long">
        SELECT count(*) FROM NIS_TFMX 
        <include refid="where"/>    
    </select>
    
    <select id="findByEntity" resultType="NisTfmx">
        SELECT <include refid="columns" />
        FROM NIS_TFMX 
        <include refid="where"/>
        
        <if test="@sqlt.Ognl@orderIsNotEmpty(sortColumns)">
            ORDER BY ${sortColumns}
        </if>
    </select>
    <!--     业务sql      -->
    
    <!-- 退费单未确认表单记录数 -->
    <select id="queryRefundNotSure" resultType="NisTfmx">
        SELECT <include refid="columns" />
	  FROM NIS_TFMX
	 WHERE (NIS_TFMX.ZYH = #{zyh})
	   AND (NIS_TFMX.TFRQ IS NULL) 
	   and NIS_TFMX.JGID = #{jgid}
    </select>
</mapper>

